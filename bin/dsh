#!/bin/bash
VERSION="0.1"
DESCRIPTION="Command/Subcommand line script template"


exists()
{
  command -v "$1" >/dev/null 2>&1
}


usage() {
  echo "Usage: dsh" 1>&2; exit 1;
}


st() {
  docker ps -a
}


up() {
  open -a Docker
	docker-compose up -d
  docker exec -it crispy-mongo mongo admin
  docker build -t crispy-node .
}


reload() {
	docker-machine restart
  docker-machine env
  eval $(docker-machine env)
  docker-compose up -d
  # docker run --name crispy-mongo -d mongo --auth
  # docker exec -it crispy-mongo mongo admin --rm mongo sh -c 'exec mongo "db.createUser({ user: \"admin\", pwd: \"123\", roles: [ { role: \"admin\", db: \"crispy\" } ] });"'
  # docker exec -it crispy-mongo mongo admin "db.createUser({ user: 'admin', pwd: '123', roles: [ { role: \"admin\", db: \"crispy\" } ] });"
  #docker-compose restart
}

destroy() {
  docker stop $(docker ps -a -q)
  docker rm $(docker ps -a -q)
}

cleanup() {
  docker rm $(docker ps -q -f status=exited)
  dsh reload
}

if exists $1; then
  $1
else
  echo "Subcommand not found: $1"
  dsh usage
fi